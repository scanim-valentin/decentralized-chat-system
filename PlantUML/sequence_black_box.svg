<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1895px" preserveAspectRatio="none" style="width:802px;height:1895px;background:#FFFFFF;" version="1.1" viewBox="0 0 802 1895" width="802px" zoomAndPan="magnify"><defs><filter height="300%" id="f1nf0yn36wzsud" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="106.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="183.9219"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="269" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="390.3828"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="107.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="764.4375"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="214.8125" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="902.1953"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="46.7031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="1147.3594"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="197.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="1378.5234"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="123.7578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="1650.6875"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="521.5" y="437.0859"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="671" y="794.7891"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="671" y="1482.5781"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="765" y="979.25"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="324.7031" style="stroke:#000000;stroke-width:2.0;" width="612.5" x="10" y="349.6797"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="184.9453" style="stroke:#000000;stroke-width:2.0;" width="592.5" x="20" y="482.4375"/><rect fill="#FFFFFF" height="46.1875" style="stroke:none;stroke-width:1.0;" width="592.5" x="20" y="621.1953"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="51" x2="51" y1="107.2188" y2="1792.4453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="299" x2="299" y1="107.2188" y2="1792.4453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="526.5" x2="526.5" y1="107.2188" y2="1792.4453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="675.5" x2="675.5" y1="107.2188" y2="1792.4453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="769.5" x2="769.5" y1="107.2188" y2="1792.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="30" y="104.1426">User1</text><ellipse cx="51.5" cy="32.6094" fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M51.5,40.6094 L51.5,67.6094 M38.5,48.6094 L64.5,48.6094 M51.5,67.6094 L38.5,82.6094 M51.5,67.6094 L64.5,82.6094 " fill="none" filter="url(#f1nf0yn36wzsud)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="30" y="1805.9785">User1</text><ellipse cx="51.5" cy="1819.0547" fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M51.5,1827.0547 L51.5,1854.0547 M38.5,1835.0547 L64.5,1835.0547 M51.5,1854.0547 L38.5,1869.0547 M51.5,1854.0547 L64.5,1869.0547 " fill="none" filter="url(#f1nf0yn36wzsud)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="85" x="255" y="70.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="262" y="92.1426">Chat Agent</text><rect fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="85" x="255" y="1791.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="262" y="1812.9785">Chat Agent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="498.5" y="86.5332">Network</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="450.5" y="104.1426">(User2,User3,...,UserN)</text><ellipse cx="526.5" cy="15" fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M526.5,23 L526.5,50 M513.5,31 L539.5,31 M526.5,50 L513.5,65 M526.5,50 L539.5,65 " fill="none" filter="url(#f1nf0yn36wzsud)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="498.5" y="1805.9785">Network</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="450.5" y="1823.5879">(User2,User3,...,UserN)</text><ellipse cx="526.5" cy="1836.6641" fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M526.5,1844.6641 L526.5,1871.6641 M513.5,1852.6641 L539.5,1852.6641 M526.5,1871.6641 L513.5,1886.6641 M526.5,1871.6641 L539.5,1886.6641 " fill="none" filter="url(#f1nf0yn36wzsud)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="616" y="86.5332">Remote Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="612.5" y="104.1426">(User*User*History)</text><ellipse cx="676" cy="15" fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M676,23 L676,50 M663,31 L689,31 M676,50 L663,65 M676,50 L689,65 " fill="none" filter="url(#f1nf0yn36wzsud)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="616" y="1805.9785">Remote Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="612.5" y="1823.5879">(User*User*History)</text><ellipse cx="676" cy="1836.6641" fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M676,1844.6641 L676,1871.6641 M663,1852.6641 L689,1852.6641 M676,1871.6641 L663,1886.6641 M676,1871.6641 L689,1886.6641 " fill="none" filter="url(#f1nf0yn36wzsud)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="749.5" y="104.1426">Clock</text><ellipse cx="770" cy="32.6094" fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M770,40.6094 L770,67.6094 M757,48.6094 L783,48.6094 M770,67.6094 L757,82.6094 M770,67.6094 L783,82.6094 " fill="none" filter="url(#f1nf0yn36wzsud)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="749.5" y="1805.9785">Clock</text><ellipse cx="770" cy="1819.0547" fill="#FEFECE" filter="url(#f1nf0yn36wzsud)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M770,1827.0547 L770,1854.0547 M757,1835.0547 L783,1835.0547 M770,1854.0547 L757,1869.0547 M770,1854.0547 L783,1869.0547 " fill="none" filter="url(#f1nf0yn36wzsud)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="106.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="183.9219"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="269" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="390.3828"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="107.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="764.4375"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="214.8125" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="902.1953"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="46.7031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="1147.3594"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="197.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="1378.5234"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="123.7578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="294.5" y="1650.6875"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="521.5" y="437.0859"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="671" y="794.7891"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="671" y="1482.5781"/><rect fill="#FFFFFF" filter="url(#f1nf0yn36wzsud)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="765" y="979.25"/><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="795.5" x="0" y="138.3945"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="138.3945" y2="138.3945"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="141.3945" y2="141.3945"/><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="159" x="318.25" y="127.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141" x="324.25" y="144.7139">User1 opens the agent</text><polygon fill="#A80036" points="282.5,179.9219,292.5,183.9219,282.5,187.9219,286.5,183.9219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="288.5" y1="183.9219" y2="183.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="58.5" y="179.0654">Opens Agent</text><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="346.5" y1="230.625" y2="230.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="346.5" x2="346.5" y1="230.625" y2="243.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="305.5" x2="346.5" y1="243.625" y2="243.625"/><polygon fill="#A80036" points="315.5,239.625,305.5,243.625,315.5,247.625,311.5,243.625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="311.5" y="209.417">isUsernameValid = False</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="311.5" y="225.7686">user_list = null</text><polygon fill="#A80036" points="62.5,286.3281,52.5,290.3281,62.5,294.3281,58.5,290.3281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="298.5" y1="290.3281" y2="290.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="68.5" y="269.1201">Shows UI :</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="68.5" y="285.4717">Username Input</text><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="795.5" x="0" y="319.5039"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="319.5039" y2="319.5039"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="322.5039" y2="322.5039"/><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="96" x="349.75" y="308.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="78" x="355.75" y="325.8232">Login phase</text><path d="M10,349.6797 L83,349.6797 L83,357.6797 L73,367.6797 L10,367.6797 L10,349.6797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="324.7031" style="stroke:#000000;stroke-width:2.0;" width="612.5" x="10" y="349.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="25" y="364.1748">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="115" x="98" y="363.0986">[if !isUsernameValid]</text><polygon fill="#A80036" points="282.5,386.3828,292.5,390.3828,282.5,394.3828,286.5,390.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="288.5" y1="390.3828" y2="390.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="58.5" y="385.5264">Logins as "name"</text><polygon fill="#A80036" points="509.5,433.0859,519.5,437.0859,509.5,441.0859,513.5,437.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="515.5" y1="437.0859" y2="437.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="311.5" y="415.8779">(UDP)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="311.5" y="432.2295">verifyUnicity()</text><polygon fill="#A80036" points="315.5,463.4375,305.5,467.4375,315.5,471.4375,311.5,467.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="309.5" x2="525.5" y1="467.4375" y2="467.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="321.5" y="462.5811">user_list</text><path d="M20,482.4375 L81,482.4375 L81,490.4375 L71,500.4375 L20,500.4375 L20,482.4375 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="184.9453" style="stroke:#000000;stroke-width:2.0;" width="592.5" x="20" y="482.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="35" y="496.9326">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="175" x="96" y="495.8564">[user_list.find("name") == false]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="346.5" y1="523.1406" y2="523.1406"/><line style="stroke:#A80036;stroke-width:1.0;" x1="346.5" x2="346.5" y1="523.1406" y2="536.1406"/><line style="stroke:#A80036;stroke-width:1.0;" x1="305.5" x2="346.5" y1="536.1406" y2="536.1406"/><polygon fill="#A80036" points="315.5,532.1406,305.5,536.1406,315.5,540.1406,311.5,536.1406" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="311.5" y="518.2842">isUsernameValid = True</text><polygon fill="#A80036" points="62.5,562.4922,52.5,566.4922,62.5,570.4922,58.5,566.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="293.5" y1="566.4922" y2="566.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="68.5" y="561.6357">Shows Connected User List</text><polygon fill="#A80036" points="514.5,609.1953,524.5,613.1953,514.5,617.1953,518.5,613.1953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="520.5" y1="613.1953" y2="613.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="311.5" y="591.9873">(UDP)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="311.5" y="608.3389">notifyConnection("name")</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="612.5" y1="622.1953" y2="622.1953"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="171" x="25" y="633.6143">[user_list.find("name") == true]</text><polygon fill="#A80036" points="62.5,655.3828,52.5,659.3828,62.5,663.3828,58.5,659.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="298.5" y1="659.3828" y2="659.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="68.5" y="654.5264">Shows invalid input message</text><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="795.5" x="0" y="702.5586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="702.5586" y2="702.5586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="705.5586" y2="705.5586"/><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="289" x="253.25" y="691.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="271" x="259.25" y="708.8779">User1 wants to chat with (connected) User2</text><polygon fill="#A80036" points="282.5,760.4375,292.5,764.4375,282.5,768.4375,286.5,764.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="288.5" y1="764.4375" y2="764.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="58.5" y="743.2295">Starts Chatting Session</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="58.5" y="759.5811">with User2</text><polygon fill="#A80036" points="659,790.7891,669,794.7891,659,798.7891,663,794.7891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="665" y1="794.7891" y2="794.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="311.5" y="789.9326">retrieveHistory(User2)</text><polygon fill="#A80036" points="315.5,821.1406,305.5,825.1406,315.5,829.1406,311.5,825.1406" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="309.5" x2="675" y1="825.1406" y2="825.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="321.5" y="820.2842">history_user2</text><polygon fill="#A80036" points="62.5,867.8438,52.5,871.8438,62.5,875.8438,58.5,871.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="298.5" y1="871.8438" y2="871.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="68.5" y="850.6357">Shows UI :</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="68.5" y="866.9873">Chat window with conversation history</text><polygon fill="#A80036" points="282.5,898.1953,292.5,902.1953,282.5,906.1953,286.5,902.1953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="288.5" y1="902.1953" y2="902.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="58.5" y="897.3389">Sends Message M1</text><polygon fill="#A80036" points="514.5,944.8984,524.5,948.8984,514.5,952.8984,518.5,948.8984" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="520.5" y1="948.8984" y2="948.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="311.5" y="927.6904">Request (TCP) connection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="311.5" y="944.042">with User2</text><polygon fill="#A80036" points="753,975.25,763,979.25,753,983.25,757,979.25" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="759" y1="979.25" y2="979.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="311.5" y="974.3936">getTime()</text><polygon fill="#A80036" points="315.5,1005.6016,305.5,1009.6016,315.5,1013.6016,311.5,1009.6016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="309.5" x2="769" y1="1009.6016" y2="1009.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="321.5" y="1004.7451">current_time</text><polygon fill="#A80036" points="514.5,1035.9531,524.5,1039.9531,514.5,1043.9531,518.5,1039.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="520.5" y1="1039.9531" y2="1039.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="311.5" y="1035.0967">sendMessage(User2,M1)</text><polygon fill="#A80036" points="664,1066.3047,674,1070.3047,664,1074.3047,668,1070.3047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="670" y1="1070.3047" y2="1070.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="311.5" y="1065.4482">updateHistory(User2,M1)</text><polygon fill="#A80036" points="62.5,1113.0078,52.5,1117.0078,62.5,1121.0078,58.5,1117.0078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="298.5" y1="1117.0078" y2="1117.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="68.5" y="1095.7998">Shows UI :</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="72.5" y="1112.1514">Updated chat with new message</text><polygon fill="#A80036" points="315.5,1143.3594,305.5,1147.3594,315.5,1151.3594,311.5,1147.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="309.5" x2="525.5" y1="1147.3594" y2="1147.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="321.5" y="1142.5029">Receive Messsage M2</text><polygon fill="#A80036" points="62.5,1190.0625,52.5,1194.0625,62.5,1198.0625,58.5,1194.0625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="298.5" y1="1194.0625" y2="1194.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="68.5" y="1172.8545">Shows UI :</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="72.5" y="1189.2061">Updated chat with new message</text><polygon fill="#A80036" points="287.5,1220.4141,297.5,1224.4141,287.5,1228.4141,291.5,1224.4141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="293.5" y1="1224.4141" y2="1224.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="58.5" y="1219.5576">Closes Chatting Session</text><polygon fill="#A80036" points="514.5,1283.4688,524.5,1287.4688,514.5,1291.4688,518.5,1287.4688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="299.5" x2="520.5" y1="1287.4688" y2="1287.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="306.5" y="1249.9092">End (TCP) connection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="306.5" y="1266.2607">with User2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="306.5" y="1282.6123">Close chat UI</text><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="795.5" x="0" y="1316.6445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="1316.6445" y2="1316.6445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="1319.6445" y2="1319.6445"/><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="254" x="270.75" y="1305.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="236" x="276.75" y="1322.9639">User1 receives a message from User3</text><polygon fill="#A80036" points="315.5,1374.5234,305.5,1378.5234,315.5,1382.5234,311.5,1378.5234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="309.5" x2="525.5" y1="1378.5234" y2="1378.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="321.5" y="1357.3154">Incoming TCP connection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="321.5" y="1373.667">from User3</text><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="346.5" y1="1408.875" y2="1408.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="346.5" x2="346.5" y1="1408.875" y2="1421.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="305.5" x2="346.5" y1="1421.875" y2="1421.875"/><polygon fill="#A80036" points="315.5,1417.875,305.5,1421.875,315.5,1425.875,311.5,1421.875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="311.5" y="1404.0186">Start Chatting Session with User3</text><polygon fill="#A80036" points="315.5,1448.2266,305.5,1452.2266,315.5,1456.2266,311.5,1452.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="309.5" x2="525.5" y1="1452.2266" y2="1452.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="321.5" y="1447.3701">Receive Messsage M3 from User3</text><polygon fill="#A80036" points="659,1478.5781,669,1482.5781,659,1486.5781,663,1482.5781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="665" y1="1482.5781" y2="1482.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="311.5" y="1477.7217">retrieveHistory(User3)</text><polygon fill="#A80036" points="315.5,1508.9297,305.5,1512.9297,315.5,1516.9297,311.5,1512.9297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="309.5" x2="675" y1="1512.9297" y2="1512.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="321.5" y="1508.0732">history_user3</text><polygon fill="#A80036" points="62.5,1571.9844,52.5,1575.9844,62.5,1579.9844,58.5,1575.9844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="298.5" y1="1575.9844" y2="1575.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="68.5" y="1538.4248">Shows UI :</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="72.5" y="1554.7764">Updated chat</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="68.5" y="1571.1279">with history and new message</text><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="795.5" x="0" y="1605.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="1605.1602" y2="1605.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="795.5" y1="1608.1602" y2="1608.1602"/><rect fill="#EEEEEE" filter="url(#f1nf0yn36wzsud)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="160" x="317.75" y="1593.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142" x="323.75" y="1611.4795">User1 closes the agent</text><polygon fill="#A80036" points="282.5,1646.6875,292.5,1650.6875,282.5,1654.6875,286.5,1650.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="288.5" y1="1650.6875" y2="1650.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="58.5" y="1645.8311">Closes Agent</text><polygon fill="#A80036" points="514.5,1693.3906,524.5,1697.3906,514.5,1701.3906,518.5,1697.3906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="520.5" y1="1697.3906" y2="1697.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="311.5" y="1676.1826">End (TCP) connection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="311.5" y="1692.5342">with User3</text><polygon fill="#A80036" points="514.5,1740.0938,524.5,1744.0938,514.5,1748.0938,518.5,1744.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="520.5" y1="1744.0938" y2="1744.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="311.5" y="1722.8857">(UDP)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="311.5" y="1739.2373">notifyUsers()</text><polygon fill="#A80036" points="62.5,1770.4453,52.5,1774.4453,62.5,1778.4453,58.5,1774.4453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="298.5" y1="1774.4453" y2="1774.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="68.5" y="1769.5889">Closes UI</text><!--MD5=[f8accd4632608739a0274c29e31d5ed2]
@startuml sequence_black_box
actor User1 as User
participant "Chat Agent" as chatAgent
actor "Network\n(User2,User3,...,UserN)" as Network
actor "Remote Database\n(User*User*History)" as db
actor "Clock" as Clock

== User1 opens the agent ==

User -> chatAgent ++ : Opens Agent
  chatAgent -> chatAgent : isUsernameValid = False\nuser_list = null
chatAgent -> User - - : Shows UI :\nUsername Input

== Login phase ==

loop if !isUsernameValid
User -> chatAgent ++ : Logins as "name"

chatAgent -> Network ++ : (UDP)\nverifyUnicity()
Network -> chatAgent - - : user_list
 
alt user_list.find("name") == false
chatAgent -> chatAgent : isUsernameValid = True
User <- chatAgent : Shows Connected User List
chatAgent -> Network : (UDP)\nnotifyConnection("name")
    else user_list.find("name") == true
User <- chatAgent - - : Shows invalid input message
    end
end

== User1 wants to chat with (connected) User2 ==

User -> chatAgent ++ : Starts Chatting Session\nwith User2
  chatAgent -> db ++ : retrieveHistory(User2)
  db -> chatAgent - - : history_user2
chatAgent -> User - - : Shows UI :\nChat window with conversation history

User -> chatAgent ++ : Sends Message M1
  chatAgent -> Network : Request (TCP) connection\nwith User2
  chatAgent -> Clock ++ : getTime()
  Clock -> chatAgent - - : current_time
  chatAgent -> Network : sendMessage(User2,M1)
  chatAgent -> db : updateHistory(User2,M1)
chatAgent -> User - - : Shows UI :\n Updated chat with new message

Network -> chatAgent ++ : Receive Messsage M2
chatAgent -> User - - : Shows UI :\n Updated chat with new message

User -> chatAgent : Closes Chatting Session
chatAgent -> Network : End (TCP) connection\nwith User2\nClose chat UI

== User1 receives a message from User3 ==

Network -> chatAgent ++ : Incoming TCP connection request\nfrom User3
chatAgent -> chatAgent : Start Chatting Session with User3
Network -> chatAgent : Receive Messsage M3 from User3

  chatAgent -> db ++ : retrieveHistory(User3) 
  db -> chatAgent - - : history_user3
chatAgent -> User - - : Shows UI :\n Updated chat\nwith history and new message

== User1 closes the agent ==

User -> chatAgent ++ : Closes Agent
  chatAgent -> Network : End (TCP) connection\nwith User3
  chatAgent -> Network : (UDP)\nnotifyUsers()
chatAgent -> User - - : Closes UI

@enduml

PlantUML version 1.2021.14(Fri Nov 12 17:46:50 CET 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>