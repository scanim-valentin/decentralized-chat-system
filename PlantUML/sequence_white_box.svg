<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2070px" preserveAspectRatio="none" style="width:1725px;height:2070px;background:#FFFFFF;" version="1.1" viewBox="0 0 1725 2070" width="1725px" zoomAndPan="magnify"><defs><filter height="300%" id="fl4m3gaxnohw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="2058.0002" style="stroke:#A80036;stroke-width:1.0;" width="954" x="192" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="68" x="635" y="18.077">Chat Agent</text><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="556.5" y="1370.2001"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="703.5" y="1771.2002"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1097" y="910.5999"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1097" y="1564.0001"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="1693.6004" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1323" y="274.5999"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="1798.0004" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1532" y="170.1998"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="252.1999" style="stroke:#000000;stroke-width:2.0;" width="1181" x="186" y="481.2"/><rect fill="#FFFFFF" height="73.3999" style="stroke:none;stroke-width:1.0;" width="1181" x="186" y="586.6"/><rect fill="#FFFFFF" height="73.3999" style="stroke:none;stroke-width:1.0;" width="1181" x="186" y="659.9999"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="27" x2="27" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="233" x2="233" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="337" x2="337" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="444" x2="444" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="561" x2="561" y1="876.0999" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="708" x2="708" y1="1529.5001" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="827" x2="827" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1009" x2="1009" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1102" x2="1102" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1172" x2="1172" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1328" x2="1328" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1427" x2="1427" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1537" x2="1537" y1="94.9998" y2="1977.2002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1611" x2="1611" y1="94.9998" y2="1977.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="5" y="91.2058">User1</text><ellipse cx="27" cy="21.1999" fill="#FEFECE" filter="url(#fl4m3gaxnohw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M27,29.1999 L27,56.1999 M14,37.1999 L40,37.1999 M27,56.1999 L14,71.1999 M27,56.1999 L40,71.1999 " fill="none" filter="url(#fl4m3gaxnohw)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="5" y="1989.2062">User1</text><ellipse cx="27" cy="2003.0002" fill="#FEFECE" filter="url(#fl4m3gaxnohw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M27,2011.0002 L27,2038.0002 M14,2019.0002 L40,2019.0002 M27,2038.0002 L14,2053.0002 M27,2038.0002 L40,2053.0002 " fill="none" filter="url(#fl4m3gaxnohw)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="70" x="196" y="59.1999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="203" y="79.2058">JFrames</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="70" x="196" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="203" y="1996.2062">JFrames</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="111" x="280" y="59.1999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="287" y="79.2058">Main Controller</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="111" x="280" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="287" y="1996.2062">Main Controller</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="74" x="405" y="59.1999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="412" y="79.2058">Launcher</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="74" x="405" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="412" y="1996.2062">Launcher</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="133" x="493" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="500" y="1996.2062">Chatting Session 1</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="133" x="640" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="647" y="1996.2062">Chatting Session 2</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="76" x="787" y="25.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="798.5" y="45.606">Chatting</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="800" y="62.4059">Session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="794" y="79.2058">Controller</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="76" x="787" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="798.5" y="1996.2062">Chatting</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="800" y="2013.0061">Session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="794" y="2029.806">Controller</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="82" x="966" y="25.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="973" y="45.606">Distributed</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="992" y="62.4059">Data</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="976" y="79.2058">Controller</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="82" x="966" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="973" y="1996.2062">Distributed</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="992" y="2013.0061">Data</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="976" y="2029.806">Controller</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="76" x="1062" y="25.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="1075" y="45.606">Remote</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1069.5" y="62.4059">Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1069" y="79.2058">Controller</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="76" x="1062" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="1075" y="1996.2062">Remote</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1069.5" y="2013.0061">Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1069" y="2029.806">Controller</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="1152" y="91.2058">Clock</text><ellipse cx="1172.5" cy="21.1999" fill="#FEFECE" filter="url(#fl4m3gaxnohw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1172.5,29.1999 L1172.5,56.1999 M1159.5,37.1999 L1185.5,37.1999 M1172.5,56.1999 L1159.5,71.1999 M1172.5,56.1999 L1185.5,71.1999 " fill="none" filter="url(#fl4m3gaxnohw)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="1152" y="1989.2062">Clock</text><ellipse cx="1172.5" cy="2003.0002" fill="#FEFECE" filter="url(#fl4m3gaxnohw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1172.5,2011.0002 L1172.5,2038.0002 M1159.5,2019.0002 L1185.5,2019.0002 M1172.5,2038.0002 L1159.5,2053.0002 M1172.5,2038.0002 L1185.5,2053.0002 " fill="none" filter="url(#fl4m3gaxnohw)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="1299" y="91.2058">Network</text><ellipse cx="1328" cy="21.1999" fill="#FEFECE" filter="url(#fl4m3gaxnohw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1328,29.1999 L1328,56.1999 M1315,37.1999 L1341,37.1999 M1328,56.1999 L1315,71.1999 M1328,56.1999 L1341,71.1999 " fill="none" filter="url(#fl4m3gaxnohw)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="1299" y="1989.2062">Network</text><ellipse cx="1328" cy="2003.0002" fill="#FEFECE" filter="url(#fl4m3gaxnohw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1328,2011.0002 L1328,2038.0002 M1315,2019.0002 L1341,2019.0002 M1328,2038.0002 L1315,2053.0002 M1328,2038.0002 L1341,2053.0002 " fill="none" filter="url(#fl4m3gaxnohw)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="1367" y="91.2058">Remote Database</text><ellipse cx="1427.5" cy="21.1999" fill="#FEFECE" filter="url(#fl4m3gaxnohw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1427.5,29.1999 L1427.5,56.1999 M1414.5,37.1999 L1440.5,37.1999 M1427.5,56.1999 L1414.5,71.1999 M1427.5,56.1999 L1440.5,71.1999 " fill="none" filter="url(#fl4m3gaxnohw)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="1367" y="1989.2062">Remote Database</text><ellipse cx="1427.5" cy="2003.0002" fill="#FEFECE" filter="url(#fl4m3gaxnohw)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1427.5,2011.0002 L1427.5,2038.0002 M1414.5,2019.0002 L1440.5,2019.0002 M1427.5,2038.0002 L1414.5,2053.0002 M1427.5,2038.0002 L1440.5,2053.0002 " fill="none" filter="url(#fl4m3gaxnohw)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="74" x="1498" y="59.1999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1505" y="79.2058">Launcher</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="74" x="1498" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1505" y="1996.2062">Launcher</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="46" x="1586" y="59.1999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="1593" y="79.2058">DDM</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="46" x="1586" y="1976.2002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="1593" y="1996.2062">DDM</text><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="556.5" y="1370.2001"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="703.5" y="1771.2002"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1097" y="910.5999"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1097" y="1564.0001"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="1693.6004" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1323" y="274.5999"/><rect fill="#FFFFFF" filter="url(#fl4m3gaxnohw)" height="1798.0004" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1532" y="170.1998"/><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1718" x="0" y="125.7998"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="125.7998" y2="125.7998"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="128.7998" y2="128.7998"/><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="156" x="781" y="114.9998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138" x="787" y="131.0768">User1 opens the agent</text><polygon fill="#A80036" points="1520,166.1998,1530,170.1998,1520,174.1998,1524,170.1998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="27" x2="1526" y1="170.1998" y2="170.1998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="34" y="164.6768">Opens Agent</text><polygon fill="#A80036" points="1020,195.7998,1010,199.7998,1020,203.7998,1016,199.7998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1014" x2="1531" y1="199.7998" y2="199.7998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="1026" y="194.2768">start_deamon()</text><polygon fill="#A80036" points="244,225.3998,234,229.3998,244,233.3998,240,229.3998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="238" x2="1531" y1="229.3998" y2="229.3998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="250" y="223.8768">new ConnectWindow()</text><polygon fill="#A80036" points="1311,270.5999,1321,274.5999,1311,278.5999,1315,274.5999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1009" x2="1317" y1="274.5999" y2="274.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="1016" y="253.4769">Request via</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="1016" y="269.0769">UDP broadcast</text><polygon fill="#A80036" points="1020,300.1999,1010,304.1999,1020,308.1999,1016,304.1999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1014" x2="1322" y1="304.1999" y2="304.1999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="1026" y="298.6769">User2_ID, ethernet address</text><polygon fill="#A80036" points="1020,329.7999,1010,333.7999,1020,337.7999,1016,333.7999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1014" x2="1322" y1="333.7999" y2="333.7999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="1026" y="328.2769">. . .</text><polygon fill="#A80036" points="1020,359.3999,1010,363.3999,1020,367.3999,1016,363.3999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1014" x2="1322" y1="363.3999" y2="363.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="1026" y="357.8769">UserN_ID</text><polygon fill="#A80036" points="244,388.9999,234,392.9999,244,396.9999,240,392.9999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="238" x2="1008" y1="392.9999" y2="392.9999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="250" y="387.4769">user_list</text><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1718" x="0" y="421.7999"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="421.7999" y2="421.7999"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="424.7999" y2="424.7999"/><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="95" x="811.5" y="410.9999"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="77" x="817.5" y="427.0769">Login phase</text><polygon fill="#A80036" points="221,462.2,231,466.2,221,470.2,225,466.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="27" x2="227" y1="466.2" y2="466.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="34" y="460.677">Login attempt as "name"</text><path d="M186,481.2 L246,481.2 L246,488.2 L236,498.2 L186,498.2 L186,481.2 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="252.1999" style="stroke:#000000;stroke-width:2.0;" width="1181" x="186" y="481.2"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="201" y="494.277">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="194" x="261" y="493.4189">[setUsername("name") == SUCCESS]</text><polygon fill="#A80036" points="1311,532,1321,536,1311,540,1315,536" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1009" x2="1317" y1="536" y2="536"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="1016" y="514.877">Notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1016" y="530.477">via UDP broadcast</text><line style="stroke:#A80036;stroke-width:1.0;" x1="191" x2="233" y1="565.6" y2="565.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="191" x2="191" y1="565.6" y2="578.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="191" x2="232" y1="578.6" y2="578.6"/><polygon fill="#A80036" points="224,574.6,234,578.6,224,582.6,228,578.6" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="126" y="560.077">new ChatWindow()</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="186" x2="1367" y1="587.6" y2="587.6"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="246" x="191" y="597.8189">[setUsername("name") == INVALID_CONTENT]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="191" x2="233" y1="638.9999" y2="638.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="191" x2="191" y1="638.9999" y2="651.9999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="191" x2="232" y1="651.9999" y2="651.9999"/><polygon fill="#A80036" points="224,647.9999,234,651.9999,224,655.9999,228,651.9999" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="41" y="617.8769">Error Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="41" y="633.4769">"Name contains illegal character"</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="186" x2="1367" y1="660.9999" y2="660.9999"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="239" x="191" y="671.2189">[setUsername("name") == ALREADY_TAKEN]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="191" x2="233" y1="712.3999" y2="712.3999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="191" x2="191" y1="712.3999" y2="725.3999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="191" x2="232" y1="725.3999" y2="725.3999"/><polygon fill="#A80036" points="224,721.3999,234,725.3999,224,729.3999,228,725.3999" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="101" y="691.2769">Error Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="101" y="706.8769">"Name Already Taken"</text><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1718" x="0" y="761.1999"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="761.1999" y2="761.1999"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="764.1999" y2="764.1999"/><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="284" x="717" y="750.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="266" x="723" y="766.4769">User1 wants to chat with (connected) User2</text><polygon fill="#A80036" points="221,801.5999,231,805.5999,221,809.5999,225,805.5999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="27" x2="227" y1="805.5999" y2="805.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="34" y="800.0769">Select User2 in user list</text><polygon fill="#A80036" points="1090,831.1999,1100,835.1999,1090,839.1999,1094,835.1999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="233" x2="1096" y1="835.1999" y2="835.1999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="240" y="829.6769">newChat("user2")</text><polygon fill="#A80036" points="641,845.1999,631,849.1999,641,853.1999,637,849.1999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="635" x2="1101" y1="849.1999" y2="849.1999"/><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="133" x="493" y="843.1999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="500" y="863.2059">Chatting Session 1</text><polygon fill="#A80036" points="1085,906.5999,1095,910.5999,1085,914.5999,1089,910.5999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="561.5" x2="1091" y1="910.5999" y2="910.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="568.5" y="905.0769">retrieveHistory(User2)</text><polygon fill="#A80036" points="1415.5,936.1999,1425.5,940.1999,1415.5,944.1999,1419.5,940.1999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1107" x2="1421.5" y1="940.1999" y2="940.1999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1114" y="934.6769">SQL request</text><polygon fill="#A80036" points="1118,965.7999,1108,969.7999,1118,973.7999,1114,969.7999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1112" x2="1426.5" y1="969.7999" y2="969.7999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1124" y="964.2769">history_user2</text><polygon fill="#A80036" points="572.5,995.3999,562.5,999.3999,572.5,1003.3999,568.5,999.3999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="566.5" x2="1101" y1="999.3999" y2="999.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="578.5" y="993.8769">conversation+=history_user2</text><polygon fill="#A80036" points="244,1024.9999,234,1028.9999,244,1032.9999,240,1028.9999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="238" x2="560.5" y1="1028.9999" y2="1028.9999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="250" y="1023.4769">refresh_messages()</text><polygon fill="#A80036" points="221,1054.5999,231,1058.5999,221,1062.5999,225,1058.5999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="27" x2="227" y1="1058.5999" y2="1058.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="34" y="1053.0769">Sends Message "hello"</text><polygon fill="#A80036" points="815,1084.1999,825,1088.1999,815,1092.1999,819,1088.1999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="233" x2="821" y1="1088.1999" y2="1088.1999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="240" y="1082.6769">sendMessage("hello","user2")</text><polygon fill="#A80036" points="572.5,1113.7999,562.5,1117.7999,572.5,1121.7999,568.5,1117.7999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="566.5" x2="826" y1="1117.7999" y2="1117.7999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="578.5" y="1112.2769">send("hello")</text><polygon fill="#A80036" points="1160.5,1143.4,1170.5,1147.4,1160.5,1151.4,1164.5,1147.4" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="561.5" x2="1166.5" y1="1147.4" y2="1147.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="568.5" y="1141.877">getTime()</text><polygon fill="#A80036" points="572.5,1173,562.5,1177,572.5,1181,568.5,1177" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="566.5" x2="1171.5" y1="1177" y2="1177"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="578.5" y="1171.477">new TimeStamp()</text><polygon fill="#A80036" points="1311,1218.2,1321,1222.2,1311,1226.2,1315,1222.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="561.5" x2="1317" y1="1222.2" y2="1222.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="568.5" y="1201.077">Establish (TCP) connection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="568.5" y="1216.677">with User2</text><polygon fill="#A80036" points="1311,1247.8,1321,1251.8,1311,1255.8,1315,1251.8" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="561.5" x2="1317" y1="1251.8" y2="1251.8"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="568.5" y="1246.277">sendMessage(User2,M1)</text><polygon fill="#A80036" points="1090,1277.4,1100,1281.4,1090,1285.4,1094,1281.4" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="561.5" x2="1096" y1="1281.4" y2="1281.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="568.5" y="1275.877">updateHistory(User2,M1)</text><polygon fill="#A80036" points="1415.5,1307,1425.5,1311,1415.5,1315,1419.5,1311" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1102" x2="1421.5" y1="1311" y2="1311"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1109" y="1305.477">SQL request</text><polygon fill="#A80036" points="244,1336.6001,234,1340.6001,244,1344.6001,240,1340.6001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="238" x2="560.5" y1="1340.6001" y2="1340.6001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="250" y="1335.0771">addMessage(M1)</text><polygon fill="#A80036" points="577.5,1366.2001,567.5,1370.2001,577.5,1374.2001,573.5,1370.2001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="571.5" x2="1322" y1="1370.2001" y2="1370.2001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="583.5" y="1364.6771">receiveMessage(User2,M2)</text><polygon fill="#A80036" points="244,1395.8001,234,1399.8001,244,1403.8001,240,1399.8001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="238" x2="560.5" y1="1399.8001" y2="1399.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="250" y="1394.2771">addMessage(M2)</text><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1718" x="0" y="1428.6001"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="1428.6001" y2="1428.6001"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="1431.6001" y2="1431.6001"/><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="250" x="734" y="1417.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="740" y="1433.8771">User1 receives a message from User3</text><polygon fill="#A80036" points="1113,1484.6001,1103,1488.6001,1113,1492.6001,1109,1488.6001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1107" x2="1322" y1="1488.6001" y2="1488.6001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="1119" y="1467.4771">Incoming TCP connection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="1119" y="1483.0771">from User3</text><polygon fill="#A80036" points="788,1514.2001,778,1518.2001,788,1522.2001,784,1518.2001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="782" x2="1101" y1="1518.2001" y2="1518.2001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="794" y="1512.6771">newChat(User3)</text><rect fill="#FEFECE" filter="url(#fl4m3gaxnohw)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="133" x="640" y="1496.6001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="647" y="1516.6061">Chatting Session 2</text><polygon fill="#A80036" points="1085,1560.0001,1095,1564.0001,1085,1568.0001,1089,1564.0001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="708.5" x2="1091" y1="1564.0001" y2="1564.0001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="715.5" y="1558.4771">retrieveHistory(User3)</text><polygon fill="#A80036" points="1415.5,1589.6001,1425.5,1593.6001,1415.5,1597.6001,1419.5,1593.6001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1107" x2="1421.5" y1="1593.6001" y2="1593.6001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1114" y="1588.0771">SQL request</text><polygon fill="#A80036" points="1118,1619.2001,1108,1623.2001,1118,1627.2001,1114,1623.2001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1112" x2="1426.5" y1="1623.2001" y2="1623.2001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1124" y="1617.6771">history_user3</text><polygon fill="#A80036" points="719.5,1648.8001,709.5,1652.8001,719.5,1656.8001,715.5,1652.8001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="713.5" x2="1101" y1="1652.8001" y2="1652.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="725.5" y="1647.2771">history_user3</text><polygon fill="#A80036" points="1311,1678.4001,1321,1682.4001,1311,1686.4001,1315,1682.4001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="708.5" x2="1317" y1="1682.4001" y2="1682.4001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="715.5" y="1676.8771">Accept TCP connection with User3</text><polygon fill="#A80036" points="719.5,1708.0001,709.5,1712.0001,719.5,1716.0001,715.5,1712.0001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="713.5" x2="1101" y1="1712.0001" y2="1712.0001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="725.5" y="1706.4771">conversation+=history_user2</text><polygon fill="#A80036" points="244,1737.6002,234,1741.6002,244,1745.6002,240,1741.6002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="238" x2="707.5" y1="1741.6002" y2="1741.6002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="250" y="1736.0771">refresh_messages()</text><polygon fill="#A80036" points="724.5,1767.2002,714.5,1771.2002,724.5,1775.2002,720.5,1771.2002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="718.5" x2="1322" y1="1771.2002" y2="1771.2002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="730.5" y="1765.6772">receiveMessage(User3,M3)</text><polygon fill="#A80036" points="244,1796.8002,234,1800.8002,244,1804.8002,240,1800.8002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="238" x2="707.5" y1="1800.8002" y2="1800.8002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="250" y="1795.2772">refresh_messages()</text><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1718" x="0" y="1829.6002"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="1829.6002" y2="1829.6002"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1718" y1="1832.6002" y2="1832.6002"/><rect fill="#EEEEEE" filter="url(#fl4m3gaxnohw)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="158" x="780" y="1818.8002"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140" x="786" y="1834.8772">User1 closes the agent</text><polygon fill="#A80036" points="221,1870.0002,231,1874.0002,221,1878.0002,225,1874.0002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="27" x2="227" y1="1874.0002" y2="1874.0002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="34" y="1868.4772">Closes Agent</text><line style="stroke:#A80036;stroke-width:1.0;" x1="827" x2="869" y1="1903.6002" y2="1903.6002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="869" x2="869" y1="1903.6002" y2="1916.6002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="828" x2="869" y1="1916.6002" y2="1916.6002"/><polygon fill="#A80036" points="838,1912.6002,828,1916.6002,838,1920.6002,834,1916.6002" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="834" y="1898.0772">Closing sockets and deamon</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1611" x2="1653" y1="1946.2002" y2="1946.2002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1653" x2="1653" y1="1946.2002" y2="1959.2002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1612" x2="1653" y1="1959.2002" y2="1959.2002"/><polygon fill="#A80036" points="1622,1955.2002,1612,1959.2002,1622,1963.2002,1618,1959.2002" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="1618" y="1940.6772">Closing deamon</text><!--MD5=[3b45752fd8a87bebc5647d1685c39523]
@startuml sequence_white_box
actor User1 as User
box "Chat Agent"
  participant  "JFrames" as UI
  participant "Main Controller" as MC
  participant "Launcher" as launcher
  participant "Chatting Session 1" as chat1
  participant "Chatting Session 2" as chat2
  participant "Chatting\nSession\nController" as CSC
  participant "Distributed\nData\nController" as DDC
  participant "Remote\nDatabase\nController" as RDC
end box

actor "Clock" as Clock
actor "Network" as Network
actor "Remote Database" as db

== User1 opens the agent ==
User -> Launcher ++ : Opens Agent
  Launcher -> DDC : start_deamon()
  Launcher -> UI : new ConnectWindow()
  DDC -> Network ++: Request via\nUDP broadcast
  
  Network -> DDC : User2_ID, ethernet address
  Network -> DDC : . . . 
  Network -> DDC : UserN_ID
  
  DDC -> UI - - : user_list 
  
== Login phase ==

  User -> UI : Login attempt as "name"
  
  alt setUsername("name") == SUCCESS

    DDC -> Network : Notification\nvia UDP broadcast
    UI <- UI : new ChatWindow()
  
  else setUsername("name") == INVALID_CONTENT

    UI <- UI : Error Message:\n"Name contains illegal character"
  
  else setUsername("name") == ALREADY_TAKEN

      UI <- UI : Error Message:\n"Name Already Taken"

  end

== User1 wants to chat with (connected) User2 ==

User -> UI : Select User2 in user list
  UI -> RDC : newChat("user2")
  RDC -> chat1 ** 
  chat1 -> RDC ++ : retrieveHistory(User2)
    RDC -> db : SQL request
    db -> RDC : history_user2
  RDC -> chat1 - - : conversation+=history_user2

chat1 -> UI - - : refresh_messages()

User -> UI : Sends Message "hello"
UI -> CSC : sendMessage("hello","user2")
CSC -> chat1 : send("hello")
chat1 -> Clock : getTime()
Clock -> chat1 : new TimeStamp()

chat1 -> Network : Establish (TCP) connection\nwith User2
chat1 -> Network : sendMessage(User2,M1)

chat1 -> RDC : updateHistory(User2,M1)
    RDC -> db : SQL request
chat1 -> UI - - : addMessage(M1)

Network -> chat1 ++ : receiveMessage(User2,M2)
chat1 -> UI - - : addMessage(M2)

== User1 receives a message from User3 ==

Network -> RDC : Incoming TCP connection request\nfrom User3
  RDC -> chat2 ** : newChat(User3)
    chat2 -> RDC ++ : retrieveHistory(User3)
    RDC -> db : SQL request
    db -> RDC : history_user3
  RDC -> chat2 - - : history_user3
  chat2 -> Network : Accept TCP connection with User3 
  RDC -> chat2  : conversation+=history_user2
  chat2 -> UI : refresh_messages()
  Network -> chat2 ++: receiveMessage(User3,M3)
  chat2 -> UI - - : refresh_messages()

== User1 closes the agent ==

User -> UI : Closes Agent
CSC -> CSC : Closing sockets and deamon
DDM -> DDM : Closing deamon

@enduml

PlantUML version 1.2021.14(Fri Nov 12 17:46:50 CET 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>