<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="3102px" preserveAspectRatio="none" style="width:1399px;height:3102px;background:#FFFFFF;" version="1.1" viewBox="0 0 1399 3102" width="1399px" zoomAndPan="magnify"><defs><filter height="300%" id="fzmftz1zxht66" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="3090.0001" style="stroke:#A80036;stroke-width:1.0;" width="868.5" x="165.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="68" x="565.75" y="18.077">Chat Agent</text><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="360.5996" style="stroke:#A80036;stroke-width:1.0;" width="10" x="454" y="180.7999"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="624.5" y="1677.5998"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="254.0001" style="stroke:#A80036;stroke-width:1.0;" width="10" x="771.5" y="2326.8"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="163.6001" style="stroke:#A80036;stroke-width:1.0;" width="10" x="893" y="630.1995"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="985.5" y="1217.9996"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="985.5" y="2016.7998"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1055.5" y="2476.4"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="523.0001" style="stroke:#000000;stroke-width:2.0;" width="1257" x="10" y="502.1994"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="209.4" style="stroke:#000000;stroke-width:2.0;" width="1097.5" x="159.5" y="808.7996"/><rect fill="#FFFFFF" height="44.7999" style="stroke:none;stroke-width:1.0;" width="1097.5" x="159.5" y="973.3996"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="42" x2="42" y1="105.5999" y2="2992.4002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="215.5" x2="215.5" y1="380.4994" y2="2992.4002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="459" x2="459" y1="105.5999" y2="2992.4002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="629" x2="629" y1="1183.4996" y2="2992.4002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="776" x2="776" y1="1982.2998" y2="2992.4002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="898" x2="898" y1="238.4998" y2="2992.4002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="990" x2="990" y1="317.8996" y2="2992.4002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1060" x2="1060" y1="105.5999" y2="2992.4002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1169" x2="1169" y1="105.5999" y2="2992.4002"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1322" x2="1322" y1="105.5999" y2="2992.4002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="20" y="101.8059">User1</text><ellipse cx="42" cy="31.7999" fill="#FEFECE" filter="url(#fzmftz1zxht66)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M42,39.7999 L42,66.7999 M29,47.7999 L55,47.7999 M42,66.7999 L29,81.7999 M42,66.7999 L55,81.7999 " fill="none" filter="url(#fzmftz1zxht66)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="20" y="3004.4062">User1</text><ellipse cx="42" cy="3018.2002" fill="#FEFECE" filter="url(#fzmftz1zxht66)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M42,3026.2002 L42,3053.2002 M29,3034.2002 L55,3034.2002 M42,3053.2002 L29,3068.2002 M42,3053.2002 L55,3068.2002 " fill="none" filter="url(#fzmftz1zxht66)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="89" x="169.5" y="2991.4002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="176.5" y="3011.4062">UI Manager</text><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="47.5999" style="stroke:#A80036;stroke-width:1.5;" width="136" x="389" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="422" y="73.0059">Main Class</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="396" y="89.8059">(and other classes)</text><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="47.5999" style="stroke:#A80036;stroke-width:1.5;" width="136" x="389" y="2991.4002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="422" y="3011.4062">Main Class</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="396" y="3028.2061">(and other classes)</text><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="133" x="561" y="2991.4002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="568" y="3011.4062">Chatting Session 1</text><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="133" x="708" y="2991.4002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="715" y="3011.4062">Chatting Session 2</text><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="82" x="855" y="2991.4002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="862" y="3011.4062">Distributed</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="881" y="3028.2061">Data</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="867.5" y="3045.006">Manager</text><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="75" x="951" y="2991.4002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="963.5" y="3011.4062">Remote</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="958" y="3028.2061">Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="960" y="3045.006">Manager</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="1040" y="101.8059">Clock</text><ellipse cx="1060.5" cy="31.7999" fill="#FEFECE" filter="url(#fzmftz1zxht66)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1060.5,39.7999 L1060.5,66.7999 M1047.5,47.7999 L1073.5,47.7999 M1060.5,66.7999 L1047.5,81.7999 M1060.5,66.7999 L1073.5,81.7999 " fill="none" filter="url(#fzmftz1zxht66)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="1040" y="3004.4062">Clock</text><ellipse cx="1060.5" cy="3018.2002" fill="#FEFECE" filter="url(#fzmftz1zxht66)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1060.5,3026.2002 L1060.5,3053.2002 M1047.5,3034.2002 L1073.5,3034.2002 M1060.5,3053.2002 L1047.5,3068.2002 M1060.5,3053.2002 L1073.5,3068.2002 " fill="none" filter="url(#fzmftz1zxht66)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="1140" y="85.0059">Network</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="1091" y="101.8059">(User2,User3,...,UserN)</text><ellipse cx="1169" cy="15" fill="#FEFECE" filter="url(#fzmftz1zxht66)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1169,23 L1169,50 M1156,31 L1182,31 M1169,50 L1156,65 M1169,50 L1182,65 " fill="none" filter="url(#fzmftz1zxht66)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="1140" y="3004.4062">Network</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="1091" y="3021.2061">(User2,User3,...,UserN)</text><ellipse cx="1169" cy="3035.0001" fill="#FEFECE" filter="url(#fzmftz1zxht66)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1169,3043.0001 L1169,3070.0001 M1156,3051.0001 L1182,3051.0001 M1169,3070.0001 L1156,3085.0001 M1169,3070.0001 L1182,3085.0001 " fill="none" filter="url(#fzmftz1zxht66)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="1261.5" y="85.0059">Remote Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="1257" y="101.8059">(User*User*History)</text><ellipse cx="1322" cy="15" fill="#FEFECE" filter="url(#fzmftz1zxht66)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1322,23 L1322,50 M1309,31 L1335,31 M1322,50 L1309,65 M1322,50 L1335,65 " fill="none" filter="url(#fzmftz1zxht66)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="1261.5" y="3004.4062">Remote Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="1257" y="3021.2061">(User*User*History)</text><ellipse cx="1322" cy="3035.0001" fill="#FEFECE" filter="url(#fzmftz1zxht66)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1322,3043.0001 L1322,3070.0001 M1309,3051.0001 L1335,3051.0001 M1322,3070.0001 L1309,3085.0001 M1322,3070.0001 L1335,3085.0001 " fill="none" filter="url(#fzmftz1zxht66)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="360.5996" style="stroke:#A80036;stroke-width:1.0;" width="10" x="454" y="180.7999"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="624.5" y="1677.5998"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="254.0001" style="stroke:#A80036;stroke-width:1.0;" width="10" x="771.5" y="2326.8"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="163.6001" style="stroke:#A80036;stroke-width:1.0;" width="10" x="893" y="630.1995"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="985.5" y="1217.9996"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="985.5" y="2016.7998"/><rect fill="#FFFFFF" filter="url(#fzmftz1zxht66)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1055.5" y="2476.4"/><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1392" x="0" y="136.3999"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="136.3999" y2="136.3999"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="139.3999" y2="139.3999"/><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="156" x="618" y="125.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138" x="624" y="141.6769">User1 opens the agent</text><polygon fill="#A80036" points="442,176.7999,452,180.7999,442,184.7999,446,180.7999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="42" x2="448" y1="180.7999" y2="180.7999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="49" y="175.2769">Opens Agent</text><polygon fill="#A80036" points="843,190.7999,853,194.7999,843,198.7999,847,194.7999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="464" x2="849" y1="194.7999" y2="194.7999"/><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="82" x="855" y="188.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="862" y="208.8058">Distributed</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="881" y="225.6058">Data</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="867.5" y="242.4057">Manager</text><polygon fill="#A80036" points="939,270.1997,949,274.1997,939,278.1997,943,274.1997" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="464" x2="945" y1="274.1997" y2="274.1997"/><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="64.3998" style="stroke:#A80036;stroke-width:1.5;" width="75" x="951" y="268.1997"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="963.5" y="288.2056">Remote</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="958" y="305.0055">Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="960" y="321.8055">Manager</text><polygon fill="#A80036" points="273.5,349.5994,263.5,353.5994,273.5,357.5994,269.5,353.5994" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="267.5" x2="453" y1="353.5994" y2="353.5994"/><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="89" x="169.5" y="347.5994"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="176.5" y="367.6054">UI Manager</text><line style="stroke:#A80036;stroke-width:1.0;" x1="464" x2="506" y1="430.5994" y2="430.5994"/><line style="stroke:#A80036;stroke-width:1.0;" x1="506" x2="506" y1="430.5994" y2="443.5994"/><line style="stroke:#A80036;stroke-width:1.0;" x1="465" x2="506" y1="443.5994" y2="443.5994"/><polygon fill="#A80036" points="475,439.5994,465,443.5994,475,447.5994,471,443.5994" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="471" y="409.4764">isUsernameValid = False</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="471" y="425.0764">user_list = null</text><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1392" x="0" y="472.3994"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="472.3994" y2="472.3994"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="475.3994" y2="475.3994"/><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="95" x="648.5" y="461.5994"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="77" x="654.5" y="477.6764">Login phase</text><path d="M10,502.1994 L83,502.1994 L83,509.1994 L73,519.1994 L10,519.1994 L10,502.1994 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="523.0001" style="stroke:#000000;stroke-width:2.0;" width="1257" x="10" y="502.1994"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="25" y="515.2764">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="110" x="98" y="514.4183">[if !isUsernameValid]</text><polygon fill="#A80036" points="227,537.3994,217,541.3994,227,545.3994,223,541.3994" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="458" y1="541.3994" y2="541.3994"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="233" y="535.8764">inputDialogBox(login)</text><polygon fill="#A80036" points="204,566.9995,214,570.9995,204,574.9995,208,570.9995" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="42" x2="210" y1="570.9995" y2="570.9995"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="49" y="565.4764">Logins attempt as "name"</text><polygon fill="#A80036" points="447,596.5995,457,600.5995,447,604.5995,451,600.5995" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="216" x2="453" y1="600.5995" y2="600.5995"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="223" y="595.0765">eventLogin("name")</text><polygon fill="#A80036" points="881,626.1995,891,630.1995,881,634.1995,885,630.1995" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="887" y1="630.1995" y2="630.1995"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="466" y="624.6765">verifyUnicity()</text><polygon fill="#A80036" points="1157,671.3995,1167,675.3995,1157,679.3995,1161,675.3995" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="903" x2="1163" y1="675.3995" y2="675.3995"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="910" y="654.2765">Request via</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="910" y="669.8765">UDP broadcast</text><polygon fill="#A80036" points="914,700.9995,904,704.9995,914,708.9995,910,704.9995" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="908" x2="1168" y1="704.9995" y2="704.9995"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="920" y="699.4765">User2_ID, ethernet address</text><polygon fill="#A80036" points="914,730.5995,904,734.5995,914,738.5995,910,734.5995" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="908" x2="1168" y1="734.5995" y2="734.5995"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="920" y="729.0765">. . .</text><polygon fill="#A80036" points="914,760.1995,904,764.1995,914,768.1995,910,764.1995" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="908" x2="1168" y1="764.1995" y2="764.1995"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="920" y="758.6765">UserN_ID</text><polygon fill="#A80036" points="470,789.7996,460,793.7996,470,797.7996,466,793.7996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="464" x2="897" y1="793.7996" y2="793.7996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="476" y="788.2766">user_list</text><path d="M159.5,808.7996 L219.5,808.7996 L219.5,815.7996 L209.5,825.7996 L159.5,825.7996 L159.5,808.7996 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="209.4" style="stroke:#000000;stroke-width:2.0;" width="1097.5" x="159.5" y="808.7996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15" x="174.5" y="821.8766">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="167" x="234.5" y="821.0185">[user_list.find("name") == false]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="501" y1="847.9996" y2="847.9996"/><line style="stroke:#A80036;stroke-width:1.0;" x1="501" x2="501" y1="847.9996" y2="860.9996"/><line style="stroke:#A80036;stroke-width:1.0;" x1="460" x2="501" y1="860.9996" y2="860.9996"/><polygon fill="#A80036" points="470,856.9996,460,860.9996,470,864.9996,466,860.9996" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="466" y="842.4766">isUsernameValid = True</text><polygon fill="#A80036" points="886,886.5996,896,890.5996,886,894.5996,890,890.5996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="892" y1="890.5996" y2="890.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="466" y="885.0766">notifyConnection("name")</text><polygon fill="#A80036" points="1157,931.7996,1167,935.7996,1157,939.7996,1161,935.7996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="898" x2="1163" y1="935.7996" y2="935.7996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="905" y="914.6766">Notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="905" y="930.2766">via UDP broadcast</text><polygon fill="#A80036" points="227,961.3996,217,965.3996,227,969.3996,223,965.3996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="458" y1="965.3996" y2="965.3996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="233" y="959.8766">display(user_list)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.5" x2="1257" y1="974.3996" y2="974.3996"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="163" x="164.5" y="984.6186">[user_list.find("name") == true]</text><polygon fill="#A80036" points="227,1006.1996,217,1010.1996,227,1014.1996,223,1010.1996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="458" y1="1010.1996" y2="1010.1996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="233" y="1004.6766">errorMessage("Name Already Taken")</text><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1392" x="0" y="1052.9996"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="1052.9996" y2="1052.9996"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="1055.9996" y2="1055.9996"/><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="284" x="554" y="1042.1996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="266" x="560" y="1058.2766">User1 wants to chat with (connected) User2</text><polygon fill="#A80036" points="204,1108.9996,214,1112.9996,204,1116.9996,208,1112.9996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="42" x2="210" y1="1112.9996" y2="1112.9996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="49" y="1091.8766">Starts Chatting Session</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="49" y="1107.4766">with User2</text><polygon fill="#A80036" points="447,1138.5996,457,1142.5996,447,1146.5996,451,1142.5996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="216" x2="453" y1="1142.5996" y2="1142.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="223" y="1137.0766">eventNewChat(User2)</text><polygon fill="#A80036" points="549,1168.1996,559,1172.1996,549,1176.1996,553,1172.1996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="555" y1="1172.1996" y2="1172.1996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="466" y="1166.6766">create(User2)</text><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="133" x="561" y="1150.5996"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="568" y="1170.6056">Chatting Session 1</text><polygon fill="#A80036" points="973.5,1213.9996,983.5,1217.9996,973.5,1221.9996,977.5,1217.9996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="629.5" x2="979.5" y1="1217.9996" y2="1217.9996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="636.5" y="1212.4766">retrieveHistory(User2)</text><polygon fill="#A80036" points="1310,1243.5996,1320,1247.5996,1310,1251.5996,1314,1247.5996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="995.5" x2="1316" y1="1247.5996" y2="1247.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1002.5" y="1242.0766">SQL request</text><polygon fill="#A80036" points="1006.5,1273.1996,996.5,1277.1996,1006.5,1281.1996,1002.5,1277.1996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1000.5" x2="1321" y1="1277.1996" y2="1277.1996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1012.5" y="1271.6766">history_user2</text><polygon fill="#A80036" points="640.5,1302.7996,630.5,1306.7996,640.5,1310.7996,636.5,1306.7996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="634.5" x2="989.5" y1="1306.7996" y2="1306.7996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="646.5" y="1301.2766">history_user2</text><polygon fill="#A80036" points="227,1332.3996,217,1336.3996,227,1340.3996,223,1336.3996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="628.5" y1="1336.3996" y2="1336.3996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="233" y="1330.8766">openChattingSession(User2)</text><polygon fill="#A80036" points="227,1361.9996,217,1365.9996,227,1369.9996,223,1365.9996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="628.5" y1="1365.9996" y2="1365.9996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="233" y="1360.4766">display(history_user2)</text><polygon fill="#A80036" points="204,1391.5996,214,1395.5996,204,1399.5996,208,1395.5996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="42" x2="210" y1="1395.5996" y2="1395.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="49" y="1390.0766">Sends Message M1</text><polygon fill="#A80036" points="617.5,1421.1996,627.5,1425.1996,617.5,1429.1996,621.5,1425.1996" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="216" x2="623.5" y1="1425.1996" y2="1425.1996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="223" y="1419.6766">eventSendMessage(M1)</text><polygon fill="#A80036" points="1048.5,1450.7997,1058.5,1454.7997,1048.5,1458.7997,1052.5,1454.7997" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="629.5" x2="1054.5" y1="1454.7997" y2="1454.7997"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="636.5" y="1449.2767">getTime()</text><polygon fill="#A80036" points="640.5,1480.3997,630.5,1484.3997,640.5,1488.3997,636.5,1484.3997" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="634.5" x2="1059.5" y1="1484.3997" y2="1484.3997"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="646.5" y="1478.8767">current_time</text><polygon fill="#A80036" points="1157,1525.5997,1167,1529.5997,1157,1533.5997,1161,1529.5997" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="629.5" x2="1163" y1="1529.5997" y2="1529.5997"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="636.5" y="1508.4767">Request (TCP) connection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="636.5" y="1524.0767">with User2</text><polygon fill="#A80036" points="1157,1555.1997,1167,1559.1997,1157,1563.1997,1161,1559.1997" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="629.5" x2="1163" y1="1559.1997" y2="1559.1997"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="636.5" y="1553.6767">sendMessage(User2,M1)</text><polygon fill="#A80036" points="978.5,1584.7997,988.5,1588.7997,978.5,1592.7997,982.5,1588.7997" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="629.5" x2="984.5" y1="1588.7997" y2="1588.7997"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="636.5" y="1583.2767">updateHistory(User2,M1)</text><polygon fill="#A80036" points="1310,1614.3997,1320,1618.3997,1310,1622.3997,1314,1618.3997" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="990.5" x2="1316" y1="1618.3997" y2="1618.3997"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="997.5" y="1612.8767">SQL request</text><polygon fill="#A80036" points="227,1643.9998,217,1647.9998,227,1651.9998,223,1647.9998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="628.5" y1="1647.9998" y2="1647.9998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="233" y="1642.4768">addMessage(M1)</text><polygon fill="#A80036" points="645.5,1673.5998,635.5,1677.5998,645.5,1681.5998,641.5,1677.5998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="639.5" x2="1168" y1="1677.5998" y2="1677.5998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="651.5" y="1672.0768">receiveMessage(User2,M2)</text><polygon fill="#A80036" points="227,1703.1998,217,1707.1998,227,1711.1998,223,1707.1998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="628.5" y1="1707.1998" y2="1707.1998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="233" y="1701.6768">addMessage(M2)</text><polygon fill="#A80036" points="204,1732.7998,214,1736.7998,204,1740.7998,208,1736.7998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="42" x2="210" y1="1736.7998" y2="1736.7998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="49" y="1731.2768">Closes Chatting Session</text><polygon fill="#A80036" points="447,1762.3998,457,1766.3998,447,1770.3998,451,1766.3998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="216" x2="453" y1="1766.3998" y2="1766.3998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="223" y="1760.8768">eventClose(chat1)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="629.5" x2="671.5" y1="1780.3998" y2="1780.3998"/><line style="stroke:#A80036;stroke-width:1.0;" x1="671.5" x2="671.5" y1="1780.3998" y2="1793.3998"/><line style="stroke:#A80036;stroke-width:1.0;" x1="630.5" x2="671.5" y1="1793.3998" y2="1793.3998"/><polygon fill="#A80036" points="640.5,1789.3998,630.5,1793.3998,640.5,1797.3998,636.5,1793.3998" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="617.5,1818.9998,627.5,1822.9998,617.5,1826.9998,621.5,1822.9998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="623.5" y1="1822.9998" y2="1822.9998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="466" y="1817.4768">close()</text><line style="stroke:#A80036;stroke-width:2.0;" x1="620.5" x2="638.5" y1="1813.9998" y2="1831.9998"/><line style="stroke:#A80036;stroke-width:2.0;" x1="620.5" x2="638.5" y1="1831.9998" y2="1813.9998"/><polygon fill="#A80036" points="227,1848.5998,217,1852.5998,227,1856.5998,223,1852.5998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="458" y1="1852.5998" y2="1852.5998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="233" y="1847.0768">closeChattingSession(User2)</text><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1392" x="0" y="1881.3998"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="1881.3998" y2="1881.3998"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="1884.3998" y2="1884.3998"/><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="250" x="571" y="1870.5998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="232" x="577" y="1886.6769">User1 receives a message from User3</text><polygon fill="#A80036" points="470,1937.3999,460,1941.3999,470,1945.3999,466,1941.3999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="464" x2="1168" y1="1941.3999" y2="1941.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="476" y="1920.2769">Incoming TCP connection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="476" y="1935.8769">from User3</text><polygon fill="#A80036" points="696,1966.9999,706,1970.9999,696,1974.9999,700,1970.9999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="702" y1="1970.9999" y2="1970.9999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="466" y="1965.4769">create(User3)</text><rect fill="#FEFECE" filter="url(#fzmftz1zxht66)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="133" x="708" y="1949.3999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="715" y="1969.4058">Chatting Session 2</text><polygon fill="#A80036" points="973.5,2012.7998,983.5,2016.7998,973.5,2020.7998,977.5,2016.7998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="979.5" y1="2016.7998" y2="2016.7998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="783.5" y="2011.2768">retrieveHistory(User3)</text><polygon fill="#A80036" points="1310,2042.3998,1320,2046.3998,1310,2050.3998,1314,2046.3998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="995.5" x2="1316" y1="2046.3998" y2="2046.3998"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1002.5" y="2040.8768">SQL request</text><polygon fill="#A80036" points="1006.5,2071.9999,996.5,2075.9999,1006.5,2079.9999,1002.5,2075.9999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1000.5" x2="1321" y1="2075.9999" y2="2075.9999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1012.5" y="2070.4768">history_user3</text><polygon fill="#A80036" points="787.5,2101.5999,777.5,2105.5999,787.5,2109.5999,783.5,2105.5999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="781.5" x2="989.5" y1="2105.5999" y2="2105.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="793.5" y="2100.0769">history_user3</text><polygon fill="#A80036" points="1157,2131.1999,1167,2135.1999,1157,2139.1999,1161,2135.1999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="1163" y1="2135.1999" y2="2135.1999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="783.5" y="2129.6769">Accept TCP connection with User3</text><polygon fill="#A80036" points="227,2160.7999,217,2164.7999,227,2168.7999,223,2164.7999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="775.5" y1="2164.7999" y2="2164.7999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="233" y="2159.2769">openChattingSession(User3)</text><polygon fill="#A80036" points="227,2190.3999,217,2194.3999,227,2198.3999,223,2194.3999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="775.5" y1="2194.3999" y2="2194.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="233" y="2188.8769">display(history_user3)</text><polygon fill="#A80036" points="787.5,2219.9999,777.5,2223.9999,787.5,2227.9999,783.5,2223.9999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="781.5" x2="1168" y1="2223.9999" y2="2223.9999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="793.5" y="2218.4769">receiveMessage(User3,M3)</text><polygon fill="#A80036" points="227,2249.5999,217,2253.5999,227,2257.5999,223,2253.5999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="775.5" y1="2253.5999" y2="2253.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="233" y="2248.0769">addMessage(M3)</text><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1392" x="0" y="2282.3999"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="2282.3999" y2="2282.3999"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="2285.3999" y2="2285.3999"/><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="183" x="604.5" y="2271.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165" x="610.5" y="2287.6769">User1 sends a file to User3</text><polygon fill="#A80036" points="759.5,2322.8,769.5,2326.8,759.5,2330.8,763.5,2326.8" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="42" x2="765.5" y1="2326.8" y2="2326.8"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="49" y="2321.277">Sends File F1</text><polygon fill="#A80036" points="1157,2368,1167,2372,1157,2376,1161,2372" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="781.5" x2="1163" y1="2372" y2="2372"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="788.5" y="2350.877">File transfert request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="788.5" y="2366.477">to User3</text><polygon fill="#A80036" points="792.5,2413.2,782.5,2417.2,792.5,2421.2,788.5,2417.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="786.5" x2="1168" y1="2417.2" y2="2417.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="798.5" y="2396.077">File transfert accept</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="798.5" y="2411.677">from User3</text><polygon fill="#A80036" points="1157,2442.8,1167,2446.8,1157,2450.8,1161,2446.8" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="781.5" x2="1163" y1="2446.8" y2="2446.8"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="788.5" y="2441.277">sendFile(User3,F1)</text><polygon fill="#A80036" points="1043.5,2472.4,1053.5,2476.4,1043.5,2480.4,1047.5,2476.4" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="781.5" x2="1049.5" y1="2476.4" y2="2476.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="788.5" y="2470.877">getTime()</text><polygon fill="#A80036" points="792.5,2502.0001,782.5,2506.0001,792.5,2510.0001,788.5,2506.0001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="786.5" x2="1059.5" y1="2506.0001" y2="2506.0001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="798.5" y="2500.4771">current_time</text><polygon fill="#A80036" points="1157,2547.2001,1167,2551.2001,1157,2555.2001,1161,2551.2001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="781.5" x2="1163" y1="2551.2001" y2="2551.2001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="788.5" y="2530.0771">sendMessage(User3,M4)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="788.5" y="2545.6771">(M4 is file name, size and date it was sent)</text><polygon fill="#A80036" points="978.5,2576.8001,988.5,2580.8001,978.5,2584.8001,982.5,2580.8001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="984.5" y1="2580.8001" y2="2580.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="783.5" y="2575.2771">updateHistory(User3,M4)</text><polygon fill="#A80036" points="1310,2606.4001,1320,2610.4001,1310,2614.4001,1314,2610.4001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="990.5" x2="1316" y1="2610.4001" y2="2610.4001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="997.5" y="2604.8771">SQL request</text><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1392" x="0" y="2639.2001"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="2639.2001" y2="2639.2001"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1392" y1="2642.2001" y2="2642.2001"/><rect fill="#EEEEEE" filter="url(#fzmftz1zxht66)" height="23.6" style="stroke:#000000;stroke-width:2.0;" width="158" x="617" y="2628.4001"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140" x="623" y="2644.4771">User1 closes the agent</text><polygon fill="#A80036" points="204,2679.6001,214,2683.6001,204,2687.6001,208,2683.6001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="42" x2="210" y1="2683.6001" y2="2683.6001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="49" y="2678.0771">Closes Agent</text><polygon fill="#A80036" points="447,2709.2002,457,2713.2002,447,2717.2002,451,2713.2002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="216" x2="453" y1="2713.2002" y2="2713.2002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="223" y="2707.6772">eventClose()</text><polygon fill="#A80036" points="764.5,2738.8002,774.5,2742.8002,764.5,2746.8002,768.5,2742.8002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="770.5" y1="2742.8002" y2="2742.8002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="466" y="2737.2772">close()</text><polygon fill="#A80036" points="1157,2784.0002,1167,2788.0002,1157,2792.0002,1161,2788.0002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="1163" y1="2788.0002" y2="2788.0002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="783.5" y="2766.8772">End (TCP) connection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="783.5" y="2782.4772">with User3</text><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="818.5" y1="2802.0002" y2="2802.0002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="818.5" x2="818.5" y1="2802.0002" y2="2815.0002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="777.5" x2="818.5" y1="2815.0002" y2="2815.0002"/><polygon fill="#A80036" points="787.5,2811.0002,777.5,2815.0002,787.5,2819.0002,783.5,2815.0002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="767.5" x2="785.5" y1="2806.0002" y2="2824.0002"/><line style="stroke:#A80036;stroke-width:2.0;" x1="767.5" x2="785.5" y1="2824.0002" y2="2806.0002"/><polygon fill="#A80036" points="886,2840.6002,896,2844.6002,886,2848.6002,890,2844.6002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="892" y1="2844.6002" y2="2844.6002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="466" y="2839.0772">notifyUsers()</text><polygon fill="#A80036" points="1157,2885.8002,1167,2889.8002,1157,2893.8002,1161,2889.8002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="898" x2="1163" y1="2889.8002" y2="2889.8002"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="905" y="2868.6772">Notify via</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="905" y="2884.2772">UDP broadcast</text><polygon fill="#A80036" points="886,2899.8002,896,2903.8002,886,2907.8002,890,2903.8002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="892" y1="2903.8002" y2="2903.8002"/><line style="stroke:#A80036;stroke-width:2.0;" x1="889" x2="907" y1="2894.8002" y2="2912.8002"/><line style="stroke:#A80036;stroke-width:2.0;" x1="889" x2="907" y1="2912.8002" y2="2894.8002"/><polygon fill="#A80036" points="978.5,2913.8002,988.5,2917.8002,978.5,2921.8002,982.5,2917.8002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="984.5" y1="2917.8002" y2="2917.8002"/><line style="stroke:#A80036;stroke-width:2.0;" x1="981.5" x2="999.5" y1="2908.8002" y2="2926.8002"/><line style="stroke:#A80036;stroke-width:2.0;" x1="981.5" x2="999.5" y1="2926.8002" y2="2908.8002"/><polygon fill="#A80036" points="227,2927.8002,217,2931.8002,227,2935.8002,223,2931.8002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="221" x2="458" y1="2931.8002" y2="2931.8002"/><line style="stroke:#A80036;stroke-width:2.0;" x1="207" x2="225" y1="2922.8002" y2="2940.8002"/><line style="stroke:#A80036;stroke-width:2.0;" x1="207" x2="225" y1="2940.8002" y2="2922.8002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="459" x2="501" y1="2961.4002" y2="2961.4002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="501" x2="501" y1="2961.4002" y2="2974.4002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="460" x2="501" y1="2974.4002" y2="2974.4002"/><polygon fill="#A80036" points="470,2970.4002,460,2974.4002,470,2978.4002,466,2974.4002" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="466" y="2955.8772">close()</text><line style="stroke:#A80036;stroke-width:2.0;" x1="450" x2="468" y1="2965.4002" y2="2983.4002"/><line style="stroke:#A80036;stroke-width:2.0;" x1="450" x2="468" y1="2983.4002" y2="2965.4002"/><!--MD5=[6319dd027af378fd01487972fc746ddf]
@startuml sequence_white_box
actor User1 as User
box "Chat Agent"
  participant  "UI Manager" as UI
  participant "Main Class\n(and other classes)" as chatAgent
  participant "Chatting Session 1" as chat1
  participant "Chatting Session 2" as chat2
  participant "Distributed\nData\nManager" as distributedManager
  participant "Remote\nDatabase\nManager" as databaseManager
end box

actor "Clock" as Clock
actor "Network\n(User2,User3,...,UserN)" as Network
actor "Remote Database\n(User*User*History)" as db

== User1 opens the agent ==
User -> chatAgent ++ : Opens Agent
  chatAgent -> distributedManager **
  chatAgent -> databaseManager ** 
  UI <- chatAgent ** 
  chatAgent -> chatAgent : isUsernameValid = False\nuser_list = null
  


== Login phase ==

loop if !isUsernameValid
  chatAgent -> UI - - : inputDialogBox(login)
  User -> UI : Logins attempt as "name"
  UI -> chatAgent : eventLogin("name")

  chatAgent -> distributedManager ++ : verifyUnicity()
  distributedManager -> Network : Request via\nUDP broadcast
  
  Network -> distributedManager : User2_ID, ethernet address
  Network -> distributedManager : . . . 
  Network -> distributedManager : UserN_ID
  
  distributedManager -> chatAgent - - : user_list 
  
  alt user_list.find("name") == false

    chatAgent -> chatAgent : isUsernameValid = True
    chatAgent -> distributedManager : notifyConnection("name")
    distributedManager -> Network : Notification\nvia UDP broadcast
    UI <- chatAgent : display(user_list)
  
  else user_list.find("name") == true

      UI <- chatAgent : errorMessage("Name Already Taken")

  end

end

== User1 wants to chat with (connected) User2 ==

User -> UI : Starts Chatting Session\nwith User2
  UI -> chatAgent : eventNewChat(User2)
  chatAgent -> chat1 ** : create(User2)

  chat1 -> databaseManager ++ : retrieveHistory(User2)
    databaseManager -> db : SQL request
    db -> databaseManager : history_user2
  databaseManager -> chat1 - - : history_user2

  chat1 -> UI : openChattingSession(User2)
chat1 -> UI - - : display(history_user2)

User -> UI : Sends Message M1
UI -> chat1 : eventSendMessage(M1)
chat1 -> Clock : getTime()
Clock -> chat1 : current_time

chat1 -> Network : Request (TCP) connection\nwith User2
chat1 -> Network : sendMessage(User2,M1)

chat1 -> databaseManager : updateHistory(User2,M1)
    databaseManager -> db : SQL request
chat1 -> UI - - : addMessage(M1)

Network -> chat1 ++ : receiveMessage(User2,M2)
chat1 -> UI - - : addMessage(M2)

User -> UI : Closes Chatting Session
UI -> chatAgent : eventClose(chat1)
chat1 -> chat1 : 
chatAgent -> chat1 !! : close()
chatAgent -> UI : closeChattingSession(User2)

== User1 receives a message from User3 ==

Network -> chatAgent : Incoming TCP connection request\nfrom User3
  chatAgent -> chat2 ** : create(User3)
    chat2 -> databaseManager ++ : retrieveHistory(User3)
    databaseManager -> db : SQL request
    db -> databaseManager : history_user3
  databaseManager -> chat2 - - : history_user3
  chat2 -> Network : Accept TCP connection with User3 
  chat2 -> UI : openChattingSession(User3)
  chat2 -> UI : display(history_user3)
  Network -> chat2 : receiveMessage(User3,M3)
chat2 -> UI - - : addMessage(M3)

== User1 sends a file to User3 ==
User -> chat2 ++ : Sends File F1
chat2 -> Network : File transfert request\nto User3
Network -> chat2 : File transfert accept\nfrom User3
chat2 -> Network : sendFile(User3,F1)
chat2 -> Clock ++ : getTime()
Clock -> chat2 - - : current_time
chat2 -> Network : sendMessage(User3,M4)\n(M4 is file name, size and date it was sent)
chat2 -> databaseManager - - : updateHistory(User3,M4)
  databaseManager -> db : SQL request
== User1 closes the agent ==

User -> UI : Closes Agent
UI -> chatAgent : eventClose()
chatAgent -> chat2 : close()
chat2 -> Network : End (TCP) connection\nwith User3
chat2 -> chat2 !!
chatAgent -> distributedManager : notifyUsers()
distributedManager -> Network : Notify via\nUDP broadcast
chatAgent -> distributedManager !!
chatAgent -> databaseManager !!
chatAgent -> UI !!
chatAgent -> chatAgent !! : close()
@enduml

PlantUML version 1.2021.14(Fri Nov 12 17:46:50 CET 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>